# 软件包名称修复说明

## 问题描述

在构建 Debian/Ubuntu 系统镜像时，出现大量软件包找不到的错误：

```
Error: Unable to locate package gnome-desktop-environment
Error: Unable to locate package gnome-extensions
Error: Unable to locate package plasma-desktop
```

## 问题原因

**软件包名称不匹配：** 在 Debian/Ubuntu 系统中，桌面环境的软件包名称与脚本中预期的名称不完全匹配。

### 常见的软件包名称差异

| 脚本中的名称 | Debian/Ubuntu 中的实际名称 | 说明 |
|-------------|--------------------------|------|
| `gnome-desktop-environment` | `gnome-core` | GNOME 桌面环境核心 |
| `gnome-extensions` | 移除 | GNOME 扩展在较新版本中已移除 |
| `plasma-desktop` | `plasma-desktop` | KDE Plasma 桌面环境 |
| `plasma-meta` | 移除 | KDE 元包在较新版本中已移除 |
| `kde-standard` | 移除 | KDE 标准包已移除 |
| `gnome-extra` | `gnome-core` | GNOME 扩展包已移除 |

## 修复内容

### 1. GNOME 桌面环境修复

**修复前：**
```bash
chroot rootdir apt install -y gnome gnome-desktop-environment gnome-tweaks gnome-system-tools gnome-software gnome-text-editor gnome-logs gnome-extensions gnome-control-center gnome-backgrounds gnome-screenshot gnome-calculator gnome-calendar gnome-clocks gnome-maps gnome-music gnome-photos gnome-screenshot gnome-terminal gnome-user-docs
```

**修复后：**
```bash
chroot rootdir apt install -y gnome-core gnome-tweaks gnome-system-tools gnome-software gnome-text-editor gnome-logs gnome-control-center gnome-backgrounds gnome-screenshot gnome-calculator gnome-calendar gnome-clocks gnome-maps gnome-music gnome-photos gnome-terminal
```

### 2. KDE Plasma 桌面环境修复

**修复前：**
```bash
chroot rootdir apt install -y plasma-desktop plasma-workspace plasma-meta plasma-apps kde-standard konsole dolphin kate gwenview firefox sddm
```

**修复后：**
```bash
chroot rootdir apt install -y plasma-desktop plasma-workspace konsole dolphin kate gwenview firefox sddm
```

### 3. 其他桌面环境

**修复后的桌面环境软件包列表：**

| 桌面环境 | 主要软件包 |
|---------|----------|
| **GNOME** | `gnome-core`, `gnome-tweaks`, `gnome-software`, `gnome-terminal` |
| **KDE Plasma** | `plasma-desktop`, `plasma-workspace`, `konsole`, `dolphin` |
| **XFCE** | `xfce4-goodies`, `xfce4-terminal`, `thunar` |
| **MATE** | `mate-desktop-environment`, `mate-panel`, `mate-terminal` |
| **LXQt** | `lxqt-core`, `lxqt-meta`, `qterminal` |
| **LXDE** | `lxde-common`, `lxterminal`, `pcmanfm` |
| **Phosh** | `phosh`, `gnome-terminal`, `gnome-software` |

## 验证修复

### 1. 本地测试

```bash
# 测试脚本语法
sh -n /data/data/com.termux/files/home/linux-xiaomi-raphael-uboot/debian-desktop_build.sh && echo "✅ 语法正确"

# 测试脚本运行（需要 root 权限）
sudo sh /data/data/com.termux/files/home/linux-xiaomi-raphael-uboot/debian-desktop_build.sh "" 6.18 gnome
```

### 2. GitHub Actions 测试

**在 GitHub Actions 中重新运行工作流：**
1. 进入 Actions 页面
2. 选择 "构建系统镜像" 工作流
3. 点击 "Run workflow"
4. 选择参数并运行

## 注意事项

### 1. 软件包可用性

- 不同版本的 Debian/Ubuntu 可能有不同的软件包名称
- 建议在实际构建前先测试软件包是否可用
- 可以使用 `apt search package-name` 搜索软件包

### 2. 显示管理器

- Debian/Ubuntu 中通常使用 `lightdm` 或 `gdm3` 作为显示管理器
- Phosh 桌面环境使用 `phosh`，不需要传统的显示管理器

### 3. 网络浏览器

- Debian/Ubuntu 中可能使用 `firefox-esr` 而不是 `firefox`
- 建议使用 `firefox` 以确保兼容性

## 总结

这次修复解决了 Debian/Ubuntu 系统中软件包名称不匹配的问题。现在：

1. ✅ 所有桌面环境的软件包名称都与 Debian/Ubuntu 系统兼容
2. ✅ GitHub Actions 构建应该可以正常工作
3. ✅ 本地测试仍然有效

**修复完成！** 现在你可以放心地使用 GitHub Actions 构建系统镜像了。